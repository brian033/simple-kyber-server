"use strict";function n(n){return n&&"object"==typeof n&&"default"in n?n.default:n}Object.defineProperty(exports,"__esModule",{value:!0});var e=n(require("tiny-invariant")),t=require("@dynamic-amm/sdk"),a=require("ethers"),r=n(require("axios")),i=require("@ethersproject/constants"),o=require("@ethersproject/address"),s=n(require("bignumber.js")),c=require("ethers/lib/utils");function u(n,e,t,a,r,i,o){try{var s=n[i](o),c=s.value}catch(n){return void t(n)}s.done?e(c):Promise.resolve(c).then(a,r)}function d(n){return function(){var e=this,t=arguments;return new Promise((function(a,r){var i=n.apply(e,t);function o(n){u(i,a,r,o,s,"next",n)}function s(n){u(i,a,r,o,s,"throw",n)}o(void 0)}))}}function p(){return(p=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n}).apply(this,arguments)}var h,I,l,f,m=(function(n){var e=function(n){var e=Object.prototype,t=e.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",o=a.toStringTag||"@@toStringTag";function s(n,e,t){return Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),n[e]}try{s({},"")}catch(n){s=function(n,e,t){return n[e]=t}}function c(n,e,t,a){var r=Object.create((e&&e.prototype instanceof p?e:p).prototype),i=new g(a||[]);return r._invoke=function(n,e,t){var a="suspendedStart";return function(r,i){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===r)throw i;return{value:void 0,done:!0}}for(t.method=r,t.arg=i;;){var o=t.delegate;if(o){var s=w(o,t);if(s){if(s===d)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===a)throw a="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);a="executing";var c=u(n,e,t);if("normal"===c.type){if(a=t.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:t.done}}"throw"===c.type&&(a="completed",t.method="throw",t.arg=c.arg)}}}(n,t,i),r}function u(n,e,t){try{return{type:"normal",arg:n.call(e,t)}}catch(n){return{type:"throw",arg:n}}}n.wrap=c;var d={};function p(){}function h(){}function I(){}var l={};s(l,r,(function(){return this}));var f=Object.getPrototypeOf,m=f&&f(f(N([])));m&&m!==e&&t.call(m,r)&&(l=m);var A=I.prototype=p.prototype=Object.create(l);function v(n){["next","throw","return"].forEach((function(e){s(n,e,(function(n){return this._invoke(e,n)}))}))}function C(n,e){var a;this._invoke=function(r,i){function o(){return new e((function(a,o){!function a(r,i,o,s){var c=u(n[r],n,i);if("throw"!==c.type){var d=c.arg,p=d.value;return p&&"object"==typeof p&&t.call(p,"__await")?e.resolve(p.__await).then((function(n){a("next",n,o,s)}),(function(n){a("throw",n,o,s)})):e.resolve(p).then((function(n){d.value=n,o(d)}),(function(n){return a("throw",n,o,s)}))}s(c.arg)}(r,i,a,o)}))}return a=a?a.then(o,o):o()}}function w(n,e){var t=n.iterator[e.method];if(void 0===t){if(e.delegate=null,"throw"===e.method){if(n.iterator.return&&(e.method="return",e.arg=void 0,w(n,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var a=u(t,n.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,d;var r=a.arg;return r?r.done?(e[n.resultName]=r.value,e.next=n.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function y(n){var e={tryLoc:n[0]};1 in n&&(e.catchLoc=n[1]),2 in n&&(e.finallyLoc=n[2],e.afterLoc=n[3]),this.tryEntries.push(e)}function T(n){var e=n.completion||{};e.type="normal",delete e.arg,n.completion=e}function g(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(y,this),this.reset(!0)}function N(n){if(n){var e=n[r];if(e)return e.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,i=function e(){for(;++a<n.length;)if(t.call(n,a))return e.value=n[a],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return h.prototype=I,s(A,"constructor",I),s(I,"constructor",h),h.displayName=s(I,o,"GeneratorFunction"),n.isGeneratorFunction=function(n){var e="function"==typeof n&&n.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,I):(n.__proto__=I,s(n,o,"GeneratorFunction")),n.prototype=Object.create(A),n},n.awrap=function(n){return{__await:n}},v(C.prototype),s(C.prototype,i,(function(){return this})),n.AsyncIterator=C,n.async=function(e,t,a,r,i){void 0===i&&(i=Promise);var o=new C(c(e,t,a,r),i);return n.isGeneratorFunction(t)?o:o.next().then((function(n){return n.done?n.value:o.next()}))},v(A),s(A,o,"Generator"),s(A,r,(function(){return this})),s(A,"toString",(function(){return"[object Generator]"})),n.keys=function(n){var e=[];for(var t in n)e.push(t);return e.reverse(),function t(){for(;e.length;){var a=e.pop();if(a in n)return t.value=a,t.done=!1,t}return t.done=!0,t}},n.values=N,g.prototype={constructor:g,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!n)for(var e in this)"t"===e.charAt(0)&&t.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var e=this;function a(t,a){return o.type="throw",o.arg=n,e.next=t,a&&(e.method="next",e.arg=void 0),!!a}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=t.call(i,"catchLoc"),c=t.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(n,e){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc<=this.prev&&t.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===n||"continue"===n)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=n,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(o)},complete:function(n,e){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&e&&(this.next=e),d},finish:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===n)return this.complete(t.completion,t.afterLoc),T(t),d}},catch:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===n){var a=t.completion;if("throw"===a.type){var r=a.arg;T(t)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(n,e,t){return this.delegate={iterator:N(n),resultName:e,nextLoc:t},"next"===this.method&&(this.arg=void 0),d}},n}(n.exports);try{regeneratorRuntime=e}catch(n){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(f={exports:{}}),f.exports),A={dmm:{name:"KyberSwap",icon:"https://kyberswap.com/favicon.ico",chainIds:[t.ChainId.MAINNET,t.ChainId.MATIC,t.ChainId.BSCMAINNET,t.ChainId.AVAXMAINNET,t.ChainId.FANTOM,t.ChainId.CRONOS,t.ChainId.ARBITRUM,t.ChainId.BTTC,t.ChainId.AURORA,t.ChainId.VELAS,t.ChainId.OASIS]},kyberswap:{name:"KyberSwap",icon:"https://kyberswap.com/favicon.ico",chainIds:[t.ChainId.MAINNET,t.ChainId.MATIC,t.ChainId.BSCMAINNET,t.ChainId.AVAXMAINNET,t.ChainId.FANTOM,t.ChainId.CRONOS,t.ChainId.ARBITRUM,t.ChainId.BTTC,t.ChainId.AURORA,t.ChainId.VELAS,t.ChainId.OASIS]},uniswap:{name:"UniSwap_V2",icon:"https://www.logowik.com/content/uploads/images/uniswap-uni7403.jpg",chainIds:[t.ChainId.MAINNET]},uniswapv3:{name:"UniSwap_V3",icon:"https://www.logowik.com/content/uploads/images/uniswap-uni7403.jpg",chainIds:[t.ChainId.MAINNET,t.ChainId.ARBITRUM,t.ChainId.MATIC]},sushiswap:{name:"SushiSwap",icon:"https://res.cloudinary.com/sushi-cdn/image/fetch/f_auto,c_limit,w_32,q_auto/https://app.sushi.com/images/logo.svg",chainIds:[t.ChainId.MAINNET,t.ChainId.MATIC,t.ChainId.FANTOM,t.ChainId.ARBITRUM,t.ChainId.BSCMAINNET]},shibaswap:{name:"ShibaSwap",icon:"https://shibaswap.com/images/logo_shiba_swap.png",chainIds:[t.ChainId.MAINNET]},defiswap:{name:"DefiSwap",icon:"https://crypto.com/defi/swap/favicon.c5a5b109.png",chainIds:[t.ChainId.MAINNET]},quickswap:{name:"QuickSwap",icon:"https://quickswap.exchange/logo_circle.png",chainIds:[t.ChainId.MATIC]},dfyn:{name:"Dfyn",icon:"https://dfyn.network/assets/logos/dfyn-favicon.png",chainIds:[t.ChainId.MATIC]},firebird:{name:"Firebird",icon:"https://app.firebird.finance/favicon.png",chainIds:[t.ChainId.MATIC,t.ChainId.BSCMAINNET]},oneswap:{name:"OneSwap",icon:"https://app.firebird.finance/favicon.png",chainIds:[t.ChainId.MATIC,t.ChainId.BSCMAINNET]},wault:{name:"Wault",icon:"https://wault.finance/wp-content/uploads/2021/04/cropped-wault-new-favicon-32x32.png",chainIds:[t.ChainId.MATIC,t.ChainId.BSCMAINNET]},curve:{name:"Curve",icon:"https://curve.fi/favicon-32x32.svg",chainIds:[t.ChainId.MAINNET,t.ChainId.MATIC,t.ChainId.FANTOM,t.ChainId.ARBITRUM]},jetswap:{name:"JetSwap",icon:"https://jetswap.finance/favicon_io/favicon.ico",chainIds:[t.ChainId.MATIC,t.ChainId.BSCMAINNET,t.ChainId.FANTOM]},"iron-stable":{name:"IronSwap",icon:"https://iron.finance/icons/icon-72x72.png",chainIds:[t.ChainId.MATIC,t.ChainId.AVAXMAINNET]},polydex:{name:"PolyDex",icon:"https://www.polydex.fi/favicon.ico",chainIds:[t.ChainId.MATIC]},polycat:{name:"Polycat",icon:"https://polycat.finance/favicon-32x32.png",chainIds:[t.ChainId.MATIC]},gravity:{name:"Gravity",icon:"https://gravityfinance.io/favicon.ico",chainIds:[t.ChainId.MATIC]},cometh:{name:"ComethSwap",icon:"https://swap.cometh.io/favicon.ico",chainIds:[t.ChainId.MATIC]},dinoswap:{name:"DinoSwap",icon:"https://dinoswap.exchange/favicon.ico",chainIds:[t.ChainId.MATIC]},pancake:{name:"PancakeSwap",icon:"https://pancakeswap.finance/favicon.ico",chainIds:[t.ChainId.BSCMAINNET]},"pancake-legacy":{name:"PancakeSwap Legacy",icon:"https://pancakeswap.finance/favicon.ico",chainIds:[t.ChainId.BSCMAINNET]},mdex:{name:"Mdex",icon:"https://cdn.jsdelivr.net/gh/mdexSwap/hswap@main/favicon.png",chainIds:[t.ChainId.BSCMAINNET]},biswap:{name:"Biswap",icon:"https://biswap.org/logo.png",chainIds:[t.ChainId.BSCMAINNET]},apeswap:{name:"ApeSwap",icon:"https://apeswap.finance/favicon.ico",chainIds:[t.ChainId.MATIC,t.ChainId.BSCMAINNET]},ellipsis:{name:"Ellipsis",icon:"https://ellipsis.finance/ellipsis-light.png",chainIds:[t.ChainId.BSCMAINNET]},safeswap:{name:"SafeSwap",icon:"https://safeswap.yfdai.finance/favicon.png",chainIds:[t.ChainId.BSCMAINNET]},pantherswap:{name:"PantherSwap",icon:"https://pantherswap.com/favicon.ico",chainIds:[t.ChainId.BSCMAINNET]},nerve:{name:"Nerve",icon:"https://s2.coinmarketcap.com/static/img/coins/64x64/8755.png",chainIds:[t.ChainId.BSCMAINNET]},pangolin:{name:"Pangolin",icon:"https://pangolin.exchange/icon.svg",chainIds:[t.ChainId.AVAXMAINNET]},traderjoe:{name:"TraderJoe",icon:"https://www.traderjoexyz.com/favicon.png",chainIds:[t.ChainId.AVAXMAINNET]},spookyswap:{name:"SpookySwap",icon:"https://spookyswap.finance/favicon.ico",chainIds:[t.ChainId.FANTOM]},spiritswap:{name:"SpiritSwap",icon:"https://app.spiritswap.finance/favicon-32x32.png",chainIds:[t.ChainId.FANTOM]},paintswap:{name:"PaintSwap",icon:"https://paintswap.finance/favicon.png",chainIds:[t.ChainId.FANTOM]},morpheus:{name:"MorpheusSwap",icon:"https://morpheusswap.app/favicon.ico",chainIds:[t.ChainId.FANTOM]},beethovenx:{name:"beethoven-x",icon:"https://app.beets.fi/favicon.ico",chainIds:[t.ChainId.FANTOM]},synapse:{name:"Synapse",icon:"https://synapseprotocol.com/favicon.ico",chainIds:[t.ChainId.MAINNET,t.ChainId.BSCMAINNET,t.ChainId.MATIC,t.ChainId.AVAXMAINNET,t.ChainId.FANTOM,t.ChainId.ARBITRUM]},saddle:{name:"Saddle",icon:"https://saddle.finance/favicon-32x32.png",chainIds:[t.ChainId.MAINNET,t.ChainId.FANTOM,t.ChainId.ARBITRUM]},balancer:{name:"Balancer",icon:"https://app.balancer.fi/favicon.ico",chainIds:[t.ChainId.MAINNET,t.ChainId.MATIC,t.ChainId.ARBITRUM]},axial:{name:"Axial",icon:"https://assets.website-files.com/6189dee5e79d6e8f7e214eba/618bf2f3e40e777d4210a84f_favicon.ico",chainIds:[t.ChainId.AVAXMAINNET]},lydia:{name:"Lydia",icon:"https://www.lydia.finance/favicon.ico",chainIds:[t.ChainId.AVAXMAINNET]},yetiswap:{name:"Yeti Swap",icon:"https://exchange.yetiswap.app/favicon.png",chainIds:[t.ChainId.AVAXMAINNET]},hurricane:{name:"HurricaneSwap",icon:"https://hurricaneswap.com/favicon.png",chainIds:[t.ChainId.AVAXMAINNET]},vvs:{name:"VVS Finance",icon:"https://vvs.finance/favicon.ico",chainIds:[t.ChainId.CRONOS]},cronaswap:{name:"CronaSwap",icon:"https://app.cronaswap.org/favicon.png",chainIds:[t.ChainId.CRONOS]},crodex:{name:"Crodex",icon:"https://swap.crodex.app/favicon.png",chainIds:[t.ChainId.CRONOS]},mmf:{name:"Mad Meerkat Finance",icon:"https://mm.finance/favicon.ico",chainIds:[t.ChainId.CRONOS]},kryptodex:{name:"KryptoDEX",icon:"https://www.kryptodex.org/favicon.svg",chainIds:[t.ChainId.CRONOS]},empiredex:{name:"Empire Dex",icon:"https://bsc.empiredex.org/favicon.png",chainIds:[t.ChainId.CRONOS]},photonswap:{name:"PhotonSwap",icon:"https://photonswap.finance/logo.png",chainIds:[t.ChainId.CRONOS]},trisolaris:{name:"Trisolaris",icon:"https://www.trisolaris.io/favicon.png",chainIds:[t.ChainId.AURORA]},wannaswap:{name:"WannaSwap",icon:"https://wannaswap.finance/icon.png",chainIds:[t.ChainId.AURORA]},nearpad:{name:"NearPAD",icon:"https://i.imgur.com/6IFKjOZ.png",chainIds:[t.ChainId.AURORA]},swapr:{name:"Swapr",icon:"https://swapr.eth.link/favicon.png",chainIds:[t.ChainId.ARBITRUM]},wagyuswap:{name:"WagyuSwap",icon:"https://exchange.wagyuswap.app/images/logo.png",chainIds:[t.ChainId.VELAS]},astroswap:{name:"AstroSwap",icon:"https://exchange.astroswap.app/images/logo.png",chainIds:[t.ChainId.VELAS]},yuzuswap:{name:"YuzuSwap",icon:"https://yuzu-swap.com/yuzu-white.2d6bbbe6.svg",chainIds:[t.ChainId.OASIS]},lizard:{name:"Lizard Exchange",icon:"https://lizard.exchange/static/media/lizard_white.17de6ee5.svg",chainIds:[t.ChainId.OASIS]},valleyswap:{name:"ValleySwap_V1",icon:"https://valleyswap.com/images/logo_valley-swap_mob.svg",chainIds:[t.ChainId.OASIS]},"valleyswap-v2":{name:"ValleySwap_V2",icon:"https://valleyswap.com/images/logo_valley-swap_mob.svg",chainIds:[t.ChainId.OASIS]},gemkeeper:{name:"GemKeeper",icon:"https://gemkeeper.finance/static/media/main_logo.0ec96048.png",chainIds:[t.ChainId.OASIS]}},v=((h={all:{firebird:1,pancake:2,"pancake-legacy":2,apeswap:3,wault:3,biswap:5,polydex:5,jetswap:5,polycat:2,spookyswap:3,axial:3,cronaswap:2,gravity:2,kyberswap:0,mmf:7,kryptodex:3,cometh:9,dinoswap:8,safeswap:2,pantherswap:3,morpheus:4,wannaswap:3,swapr:2,wagyuswap:3,astroswap:3}})[t.ChainId.BSCMAINNET]={jetswap:1},h[t.ChainId.MATIC]={},h),C=((I={all:{curve:2,dmm:3,kyberswap:3,oneswap:1,ellipsis:2,nerve:1,"iron-stable":4,balancer:6,synapse:4,saddle:4,axial:4,beethovenx:6,uniswapv3:5}})[t.ChainId.MAINNET]={},I[t.ChainId.BSCMAINNET]={},I[t.ChainId.MATIC]={},I[t.ChainId.AVAXMAINNET]={},I[t.ChainId.FANTOM]={},I[t.ChainId.VELAS]={},I[t.ChainId.OASIS]={},I);function w(n){var e=A[n];return e?p({},e,{value:n}):void 0}var y=((l={})[t.ChainId.BSCMAINNET]=w("pancake"),l[t.ChainId.MATIC]=w("quickswap"),l[t.ChainId.AVAXMAINNET]=w("traderjoe"),l[t.ChainId.MAINNET]=w("uniswapv2"),l[t.ChainId.FANTOM]=w("spookyswap"),l[t.ChainId.CRONOS]=w("vvs"),l[t.ChainId.AURORA]=w("trisolaris"),l[t.ChainId.ARBITRUM]=w("sushiswap"),l[t.ChainId.VELAS]=w("wagyuswap"),l[t.ChainId.OASIS]=w("valleyswap-v2"),l);function T(n,e){var t=n.toString(2),a=e||null;return a&&a>t.length&&(t=new Array(a-t.length+1).join("0")+t),t}var g=function(n,e){var t,a;if(!n)return{};var r=function(n){return function(e){return n[e]}},i=e&&C[e]||{},o=Object.assign({},v.all||{},e&&v[e]||{}),s=Object.assign({},C.all||{},i);return p({},r(A)(n)||{},{id:null!=(t=r(o)(n))?t:1,type:null!=(a=r(s)(n))?a:0})};function N(n,e){return(new a.ethers.utils.AbiCoder).encode(n,e)}function E(n){return function(e){var t=g(e.exchange,n);return![1,4,2,6,5].includes(t.type)}}function b(n,e){return n.map((function(n){return n.map((function(n){var t,a,r,i,o=g(n.exchange,e),s=T(o.type,8)+T(o.id,8);return{data:1===o.type||4===o.type?(a=n,N(["address","address","address","int128","int128","uint256","uint256","uint256","address"],[a.pool,a.tokenIn,a.tokenOut,null==(r=a.extra)?void 0:r.tokenInIndex,null==(i=a.extra)?void 0:i.tokenOutIndex,a.swapAmount,a.limitReturnAmount||"0",a.poolLength,a.pool])):2===o.type?function(n){var e,t,a,r,i=null==(e=n.poolType)?void 0:e.toLowerCase(),o=null==(t=n.extra)?void 0:t.underlying;return N(["address","address","address","int128","int128","uint256","uint256","bool","bool"],[n.pool,n.tokenIn,n.tokenOut,null==(a=n.extra)?void 0:a.tokenInIndex,null==(r=n.extra)?void 0:r.tokenOutIndex,n.swapAmount,"0",o,"curve-tricrypto"===i])}(n):6===o.type?function(n){var e;return N(["address","bytes32","address","address","uint256","uint256"],[null==(e=n.extra)?void 0:e.vault,n.pool,n.tokenIn,n.tokenOut,n.swapAmount,n.limitReturnAmount||"0"])}(n):5===o.type?function(n){return N(["address","address","address","uint256","uint256","uint160"],[n.pool,n.tokenIn,n.tokenOut,n.swapAmount,n.limitReturnAmount||"0","0"])}(n):function(n){return N(["address","address","address","address","uint256","uint256"],[n.pool,n.tokenIn,n.tokenOut,n.recipient,n.collectAmount,n.limitReturnAmount||"0"])}(n),dexOption:(t=s,parseInt((t+"").replace(/[^01]/gi,""),2))}}))}))}function S(n){return N(["address","bool","uint256"],[n.feeReceiver,n.isInBps,n.feeAmount])}function x(n){var e=N(["address[]","uint256[]","bytes[]","uint256","bytes"],[n.firstPools,n.firstSwapAmounts,n.swapSequences.map((function(n){return N(["(bytes,uint16)[]"],[n.map((function(n){return[n.data,n.dexOption]}))])})),n.deadline,n.destTokenFeeData]);return"0x0000000000000000000000000000000000000000000000000000000000000020".concat(e.toString().slice(2))}function O(n,a){return n instanceof t.TokenAmount?n:n.currency===t.ETHER?new t.TokenAmount(t.WETH[a],n.raw):void e(!1)}function M(n,a){return n instanceof t.Token?n:n===t.ETHER?t.WETH[a]:void e(!1)}var R,k,B,U,F=function(){function n(n,e,a,r,i,o,s,c,u,d){this.tradeType=c,this.inputAmount=n,this.outputAmount=e,this.amountInUsd=a,this.amountOutUsd=r,this.receivedUsd=i,this.executionPrice=new t.Price(this.inputAmount.currency,this.outputAmount.currency,this.inputAmount.raw,this.outputAmount.raw),this.swaps=o,this.tokens=s,this.gasUsd=u,this.priceImpact=d}var i=n.prototype;return i.minimumAmountOut=function(n){if(n.lessThan(t.ZERO)&&e(!1),this.tradeType===t.TradeType.EXACT_OUTPUT)return this.outputAmount;var a=new t.Fraction(t.ONE).add(n).invert().multiply(this.outputAmount.raw).quotient;return this.outputAmount instanceof t.TokenAmount?new t.TokenAmount(this.outputAmount.token,a):t.CurrencyAmount.ether(a)},i.maximumAmountIn=function(n){if(n.lessThan(t.ZERO)&&e(!1),this.tradeType===t.TradeType.EXACT_INPUT)return this.inputAmount;var a=new t.Fraction(t.ONE).add(n).multiply(this.inputAmount.raw).quotient;return this.inputAmount instanceof t.TokenAmount?new t.TokenAmount(this.inputAmount.token,a):t.CurrencyAmount.ether(a)},n.bestTradeExactIn=function(){var i=d(m.mark((function i(o,s,c,u,d,h){var I,l,f,A,v,C,w,y,T,g,N,E,b;return m.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(void 0===u&&(u=!1),void 0===d&&(d=""),void 0===(l=s instanceof t.TokenAmount?s.token.chainId:c instanceof t.Token?c.chainId:void 0)&&e(!1),f=O(s,l),A=M(c,l),v=null==(I=f.token)?void 0:I.address,C=A.address,!v||!C){i.next=29;break}return y=new URLSearchParams(p({tokenIn:v.toLowerCase(),tokenOut:C.toLowerCase(),amountIn:null==(w=s.raw)?void 0:w.toString(),saveGas:u?"1":"0",gasInclude:u?"1":"0"},h?{gasPrice:a.BigNumber.from(h.standard).mul(Math.pow(10,9)).toString()}:{},d?{dexes:d}:{})),i.prev=10,i.next=13,r(o+"?"+y);case 13:return T=i.sent,i.next=16,T.data;case 16:if(null!=(g=i.sent)&&g.inputAmount&&null!=g&&g.outputAmount&&"0"!==g.inputAmount&&"0"!==g.outputAmount){i.next=19;break}return i.abrupt("return",null);case 19:return E=(N=function(n,e){return e instanceof t.Token?new t.TokenAmount(e,t.JSBI.BigInt(n)):t.CurrencyAmount.ether(t.JSBI.BigInt(n))})(g.inputAmount,s.currency),b=N(g.outputAmount,c),i.abrupt("return",new n(E,b,g.amountInUsd,g.amountOutUsd,g.receivedUsd,g.swaps||[],g.tokens||{},t.TradeType.EXACT_INPUT,g.gasUsd,100*(-g.amountOutUsd+g.amountInUsd)/g.amountInUsd));case 26:i.prev=26,i.t0=i.catch(10),console.error(i.t0);case 29:return i.abrupt("return",null);case 30:case"end":return i.stop()}}),i,null,[[10,26]])})));return function(n,e,t,a,r,o){return i.apply(this,arguments)}}(),n.compareDex=function(){var n=d(m.mark((function n(a,i,o){var s,c,u,d,p,h,I,l,f,A,v,C,w,T,g,N;return m.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===(d=i instanceof t.TokenAmount?i.token.chainId:o instanceof t.Token?o.chainId:void 0)&&e(!1),p=O(i,d),h=M(o,d),I=null==(s=p.token)||null==(c=s.address)?void 0:c.toLowerCase(),l=null==(u=h.address)?void 0:u.toLowerCase(),f=y[d],!(I&&l&&null!=f&&f.value)){n.next=30;break}return v=new URLSearchParams({tokenIn:I,tokenOut:l,amountIn:null==(A=i.raw)?void 0:A.toString(),saveGas:"0",gasInclude:"1",dexes:f.value}),n.prev=9,n.next=12,r(a+"?"+v);case 12:return C=n.sent,n.next=15,C.data;case 15:if(null!=(w=n.sent)&&w.inputAmount&&null!=w&&w.outputAmount){n.next=18;break}return n.abrupt("return",null);case 18:return g=(T=function(n,e){return e instanceof t.Token?new t.TokenAmount(e,t.JSBI.BigInt(n)):t.CurrencyAmount.ether(t.JSBI.BigInt(n))})(w.inputAmount,i.currency),N=T(w.outputAmount,o),n.abrupt("return",{inputAmount:g,outputAmount:N,amountInUsd:w.amountInUsd,amountOutUsd:w.amountOutUsd,receivedUsd:w.receivedUsd,comparedDex:f});case 27:n.prev=27,n.t0=n.catch(9),console.error(n.t0);case 30:return n.abrupt("return",null);case 31:case"end":return n.stop()}}),n,null,[[9,27]])})));return function(e,t,a){return n.apply(this,arguments)}}(),n}(),P="https://aggregator-api.kyberswap.com",_=((R={})[t.ChainId.MAINNET]="https://ethereum.kyber.network/v1/mainnet/geth?appId=prod-dmm-interface",R[t.ChainId.RINKEBY]="https://rinkeby.infura.io/v3/9aa3d95b3bc440fa88ea12eaa4456161",R[t.ChainId.ROPSTEN]="https://ropsten.infura.io/v3/9aa3d95b3bc440fa88ea12eaa4456161",R[t.ChainId.GÖRLI]="https://goerli.infura.io/v3/9aa3d95b3bc440fa88ea12eaa4456161",R[t.ChainId.KOVAN]="https://kovan.infura.io/v3/9aa3d95b3bc440fa88ea12eaa4456161",R[t.ChainId.MUMBAI]="https://rpc-mumbai.maticvigil.com",R[t.ChainId.MATIC]="https://polygon.dmm.exchange/v1/mainnet/geth?appId=prod-dmm",R[t.ChainId.BSCTESTNET]="https://data-seed-prebsc-1-s1.binance.org:8545",R[t.ChainId.BSCMAINNET]="https://bsc.dmm.exchange/v1/mainnet/geth?appId=prod-dmm-interface",R[t.ChainId.AVAXTESTNET]="https://api.avax-test.network/ext/bc/C/rpc",R[t.ChainId.AVAXMAINNET]="https://avalanche.dmm.exchange/v1/mainnet/geth?appId=prod-dmm",R[t.ChainId.FANTOM]="https://rpc.ftm.tools",R[t.ChainId.CRONOSTESTNET]="https://cronos-testnet-3.crypto.org:8545",R[t.ChainId.CRONOS]="https://evm-cronos.crypto.org",R[t.ChainId.BTTC]="https://bttc.dev.kyberengineering.io",R[t.ChainId.ARBITRUM]="https://arb1.arbitrum.io/rpc",R[t.ChainId.ARBITRUM_TESTNET]="https://rinkeby.arbitrum.io/rpc",R[t.ChainId.VELAS]="https://evmexplorer.velas.com/rpc",R[t.ChainId.AURORA]="https://mainnet.aurora.dev/GvfzNcGULXzWqaVahC8WPTdqEuSmwNCu3Nu3rtcVv9MD",R[t.ChainId.OASIS]="https://emerald.oasis.dev",R),L=((k={})[t.ChainId.MAINNET]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.MAINNET]),k[t.ChainId.BSCMAINNET]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.BSCMAINNET]),k[t.ChainId.AVAXMAINNET]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.AVAXMAINNET]),k[t.ChainId.MATIC]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.MATIC]),k[t.ChainId.FANTOM]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.FANTOM]),k[t.ChainId.CRONOS]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.CRONOS]),k[t.ChainId.AURORA]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.AURORA]),k[t.ChainId.ROPSTEN]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.ROPSTEN]),k[t.ChainId.MUMBAI]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.MUMBAI]),k[t.ChainId.AVAXTESTNET]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.AVAXTESTNET]),k[t.ChainId.BSCTESTNET]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.BSCTESTNET]),k[t.ChainId.CRONOSTESTNET]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.CRONOSTESTNET]),k[t.ChainId.ARBITRUM_TESTNET]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.ARBITRUM_TESTNET]),k[t.ChainId.ARBITRUM]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.ARBITRUM]),k[t.ChainId.BTTC]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.BTTC]),k[t.ChainId.VELAS]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.VELAS]),k[t.ChainId.OASIS]=new a.ethers.providers.JsonRpcProvider(_[t.ChainId.OASIS]),k),V=((B={})[t.ChainId.MAINNET]=P+"/ethereum/route",B[t.ChainId.BSCMAINNET]=P+"/bsc/route",B[t.ChainId.MATIC]=P+"/polygon/route",B[t.ChainId.AVAXMAINNET]=P+"/avalanche/route",B[t.ChainId.FANTOM]=P+"/fantom/route",B[t.ChainId.CRONOS]=P+"/cronos/route",B[t.ChainId.ARBITRUM]=P+"/arbitrum/route",B[t.ChainId.BTTC]=P+"/bttc/route",B[t.ChainId.AURORA]=P+"/aurora/route",B[t.ChainId.VELAS]=P+"/velas/route",B[t.ChainId.OASIS]=P+"/oasis/route",B),D=((U={})[t.ChainId.BSCMAINNET]="0xd12bcdfb9a39be79da3bdf02557efdcd5ca59e77",U[t.ChainId.MATIC]="0xd12bcdfb9a39be79da3bdf02557efdcd5ca59e77",U[t.ChainId.AVAXMAINNET]="0xd12bcdfb9a39be79da3bdf02557efdcd5ca59e77",U[t.ChainId.MAINNET]="0xd12bcdfb9a39be79da3bdf02557efdcd5ca59e77",U[t.ChainId.FANTOM]="0xd12bcdfb9a39be79da3bdf02557efdcd5ca59e77",U[t.ChainId.CRONOS]="0xd12bcdfb9a39be79da3bdf02557efdcd5ca59e77",U[t.ChainId.BTTC]="0xd12bcdfb9a39be79da3bdf02557efdcd5ca59e77",U[t.ChainId.ARBITRUM]="0xd12bcdfb9a39be79da3bdf02557efdcd5ca59e77",U[t.ChainId.AURORA]="0xd12bcdFB9A39BE79DA3bDF02557EFdcD5CA59e77",U[t.ChainId.VELAS]="0xd12bcdFB9A39BE79DA3bDF02557EFdcD5CA59e77",U[t.ChainId.OASIS]="0xd12bcdFB9A39BE79DA3bDF02557EFdcD5CA59e77",U),j="0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",X=[{inputs:[{components:[{components:[{internalType:"bytes",name:"data",type:"bytes"},{internalType:"uint16",name:"dexOption",type:"uint16"}],internalType:"struct IMultihopRouter.Swap[][]",name:"swapSequences",type:"tuple[][]"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"address",name:"tokenOut",type:"address"},{internalType:"uint256",name:"minTotalAmountOut",type:"uint256"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"destTokenFeeData",type:"bytes"}],internalType:"struct AggregationExecutor.SwapExecutorDescription",name:"swapExecutorDescription",type:"tuple"}],name:"nameDoesntMatter",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"pure",type:"function"}];function J(n){return n.currency===t.ETHER?j:n instanceof t.TokenAmount?n.token.address:""}function q(n){return D[n]||""}function G(n,e){return function(n,e,t){if(!function(n){try{return o.getAddress(n)}catch(n){return!1}}(n)||n===i.AddressZero)throw Error("Invalid 'address' parameter '"+n+"'.");return new a.Contract(o.getAddress(n),e,t)}(q(n),X,e)}function z(n){return"0x"+n.toString(16)}function H(n,e,t,a){return K.apply(this,arguments)}function K(){return(K=d(m.mark((function n(e,a,r,i){var o;return m.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=V[null!=i?i:t.ChainId.MAINNET]){n.next=3;break}return n.abrupt("return",null);case 3:if(!e||!a){n.next=11;break}return n.next=7,F.bestTradeExactIn(o,e,a,r,void 0,void 0);case 7:return n.abrupt("return",n.sent);case 11:return n.abrupt("return",null);case 12:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function W(){return(W=d(m.mark((function n(e){var t,a,r,i,o,s,c,u,d;return m.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.chainId,a=e.currencyInAddress,r=e.currencyInDecimals,i=e.amountIn,o=e.currencyOutAddress,s=e.currencyOutDecimals,c=e.tradeConfig,u=e.feeConfig,d=e.customTradeRoute,n.next=3,Z({chainId:t,currencyInAddress:a,currencyInDecimals:r,amountIn:i,currencyOutAddress:o,currencyOutDecimals:s,tradeConfig:c,feeConfig:u,customTradeRoute:d});case 3:return n.abrupt("return",n.sent.swapV2Parameters);case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function Y(n){var e=n.chainId,a=n.currencyInAddress,r=n.currencyInDecimals,i=n.amountIn,o=n.currencyOutAddress,s=n.currencyOutDecimals;return{chainId:e,currencyAmountIn:a===j?t.CurrencyAmount.ether(i):new t.TokenAmount(new t.Token(e,c.getAddress(a),r),i),currencyOut:o===j?t.Currency.ETHER:new t.Token(e,c.getAddress(o),s)}}function Z(n){return Q.apply(this,arguments)}function Q(){return(Q=d(m.mark((function n(a){var r,i,o,c,u,d,p,h,I,l,f,A,v,C,w,y,T,g,N,O,M,R,k,B,U,F,P,_,V,D,j,X;return m.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=a.customTradeRoute,u=Y({chainId:a.chainId,currencyInAddress:a.currencyInAddress,currencyInDecimals:a.currencyInDecimals,amountIn:r=a.amountIn,currencyOutAddress:a.currencyOutAddress,currencyOutDecimals:a.currencyOutDecimals,tradeConfig:i=a.tradeConfig,feeConfig:o=a.feeConfig}),d=u.currencyAmountIn,p=u.currencyOut,h=u.chainId,n.next=4,H(d,p,!1,h);case 4:if(I=n.sent){n.next=7;break}return n.abrupt("return",{swapV2Parameters:void 0,rawExecutorData:void 0,isUseSwapSimpleMode:void 0,tradeRoute:void 0});case 7:l=c?JSON.parse(c):I.swaps,A=I.outputAmount.currency===t.ETHER,(f=I.inputAmount.currency===t.ETHER)&&A&&e(!1),v=t.validateAndParseAddress(i.recipient),C=J(I.inputAmount),w=J(I.outputAmount),y="0x"+new s(r).toString(16),T=o&&"currency_in"===o.chargeFeeBy?o.isInBps?"0x"+new s(r).div(new s(1).minus(new s(o.feeAmount).div(1e4))).toString(16):"0x"+new s(y).plus(o.feeAmount).toString(16):y,g="0x"+new s(i.minAmountOut).toString(16),N="0x"+i.deadline.toString(16),O=o&&"currency_out"===o.chargeFeeBy?S({feeReceiver:o.feeReceiver,isInBps:o.isInBps,feeAmount:o.feeAmount}):"0x",M=[],R=[],k="0x0",B=void 0,n.t0=I.tradeType,n.next=n.t0===t.TradeType.EXACT_INPUT?26:53;break;case 26:if(M=["swap"],C&&w&&y&&g){n.next=29;break}return n.abrupt("break",53);case 29:if(F=q(null!=h?h:t.ChainId.MAINNET)){n.next=32;break}return n.abrupt("break",53);case 32:if(P=G(null!=h?h:t.ChainId.MAINNET,L[null!=h?h:t.ChainId.MAINNET]),_={},V=E(null!=h?h:t.ChainId.MAINNET),o&&"currency_in"===o.chargeFeeBy&&(_[o.feeReceiver]=new s(T).minus(y)),!(U=!f)){n.next=48;break}D=0;case 39:if(!(D<l.length)){n.next=48;break}if(V(l[D][0])){n.next=45;break}return U=!1,n.abrupt("break",48);case 45:D++,n.next=39;break;case 48:return j=function(){var n=[],e=[];l.forEach((function(t){for(var a=0;a<t.length;a++)if(0===a){var r=t[0];n.push(r.pool),e.push(r.swapAmount),V(r)&&(r.collectAmount="0"),1===t.length&&V(r)&&(r.recipient=A||"currency_out"===(null==o?void 0:o.chargeFeeBy)?F:v)}else{var i=t[a-1],s=t[a];V(i)&&V(s)?(i.recipient=s.pool,s.collectAmount="0"):V(s)?s.collectAmount="1":V(i)&&(i.recipient=F),a===t.length-1&&V(s)&&(s.recipient=A||"currency_out"===(null==o?void 0:o.chargeFeeBy)?F:v)}}));var a=b(l,null!=h?h:t.ChainId.MAINNET),r=Object.values(_).reduce((function(n,e){return n.plus(e)}),new s("0")),i=e.reduce((function(n,e){return n.plus(e)}),new s("0")),c=r.plus(i).toFixed(),u=[C,w,Object.keys(_),Object.values(_).map((function(n){return n.toFixed()})),v,c,g,z(32),O],d=x({firstPools:n,firstSwapAmounts:e,swapSequences:a,deadline:N,destTokenFeeData:O});R=[F,u,d],B={firstPools:n,firstSwapAmounts:e,swapSequences:a,deadline:N,destTokenFeeData:O}},X=function(){l.forEach((function(n){for(var e=0;e<n.length;e++)if(0===e){var t,a=n[0];f?V(a)&&(a.collectAmount=a.swapAmount):(V(a)&&(a.collectAmount=a.swapAmount),_[F]=new s(a.swapAmount).plus(null!=(t=_[F])?t:"0")),1===n.length&&V(a)&&(a.recipient=A||"currency_out"===(null==o?void 0:o.chargeFeeBy)?F:v)}else{var r=n[e-1],i=n[e];V(r)&&V(i)?(r.recipient=i.pool,i.collectAmount="0"):V(i)?i.collectAmount="1":V(r)&&(r.recipient=F),e===n.length-1&&V(i)&&(i.recipient=A||"currency_out"===(null==o?void 0:o.chargeFeeBy)?F:v)}}));var n=b(l,null!=h?h:t.ChainId.MAINNET),e=[C,w,Object.keys(_),Object.values(_).map((function(n){return n.toFixed()})),v,o&&"currency_in"===o.chargeFeeBy?o.isInBps?"0x"+new s(r).div(new s(1).minus(new s(o.feeAmount).div(1e4))).toString(16):"0x"+new s(y).plus(o.feeAmount).toString(16):y,g,z(f?0:4),O],a=P.interface.encodeFunctionData("nameDoesntMatter",[[n,C,w,g,v,N,O]]);a="0x"+a.slice(10),R=[F,e,a],B=[n,C,w,g,v,N,O]},U?j():X(),f&&(k=o&&"currency_in"===o.chargeFeeBy?T:y),n.abrupt("break",53);case 53:return n.abrupt("return",{swapV2Parameters:{methodNames:M,args:R,value:k},isUseSwapSimpleMode:U,rawExecutorData:B,tradeRoute:l});case 54:case"end":return n.stop()}}),n)})))).apply(this,arguments)}exports.AGGREGATION_EXECUTOR=D,exports.ETHER_ADDRESS=j,exports.NETWORK_URLS=_,exports.ZERO_HEX="0x0",exports.default=function(n){return W.apply(this,arguments)},exports.getData=Z,exports.getTradeExactInV2=H,exports.providers=L,exports.routerUri=V;
//# sourceMappingURL=aggregator-sdk.cjs.production.min.js.map
